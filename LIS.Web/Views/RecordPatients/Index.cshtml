@model IEnumerable<مشروع_ادار_المختبرات.DTOS.PatientRecordDto>

@{
    ViewData["Title"] = "قائمة عرض جميع السجلات الطبية";
}

<div class="container mt-5" style="direction: rtl;">

    <!-- العنوان وزر الرجوع -->
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-primary fw-bold">
            <i class="bi bi-journal-medical me-2 bi-file"></i> قائمة عرض سجلات المرضى
        </h2>
        <a asp-controller="Home" asp-action="Index"
           class="btn btn-outline-danger px-4 py-2 rounded-3 shadow-sm">
            <i class="bi bi-box-arrow-left me-1"></i> خروج
        </a>
    </div>

    <!-- رابط لعرض بيانات المرضى -->
    <a asp-controller="Patient" asp-action="Index"
       class="btn btn-outline-primary mb-4 shadow-sm">
        <i class="bi bi-people me-1"></i> عرض بيانات المرضى
    </a>

    <!-- شريط البحث -->
    <form asp-action="Index" method="get" class="mb-4">
        <div class="input-group shadow-sm">
            <input type="text" name="name" class="form-control"
                   placeholder="ابحث باسم المريض..."
                   value="@Context.Request.Query["name"]" />
            <button type="submit" class="btn btn-primary">
                <i class="bi bi-search"></i> بحث
            </button>
        </div>
    </form>

    <!-- جدول عرض البيانات -->
    <div class="table-responsive shadow-sm border rounded-3">
        <table class="table table-striped table-hover align-middle text-center">
            <thead class="table-primary text-dark">
                <tr style="font-size:14px;">
                    <th><i class="bi bi-hash"></i> رقم المريض</th>
                    <th><i class="bi bi-person"></i> اسم المريض</th>
                    <th><i class="bi bi-geo-alt"></i> العنوان</th>
                    <th><i class="bi bi-telephone"></i> الهاتف</th>
                    <th><i class="bi bi-person-badge"></i> المشرف</th>
                    <th><i class="bi bi-calendar"></i> تاريخ انشاءالسجل</th>
                    <th><i class="bi bi-gear"></i> العمليات</th>
                </tr>
            </thead>
            <tbody>
                @if (Model == null || !Model.Any())
                {
                    <tr>
                        <td colspan="7" class="text-muted py-4">
                            <i class="bi bi-info-circle me-2"></i> لا توجد بيانات لعرضها حالياً
                        </td>
                    </tr>
                }
                else
                {
                    foreach (var record in Model)
                    {
                        <tr style="font-size:13px;">
                            <td>@record.PatientId</td>
                            <td>@record.FullName</td>
                            <td>@record.Address</td>
                            <td>@record.Phone</td>
                            <td>@record.Username</td>
                            <td>@record.CreateAt.ToString("yyyy-MM-dd HH:mm")</td>
                            <td>
                                <div class="d-flex justify-content-center gap-2">
                                    <a asp-action="PrintTestResults" asp-controller="RecordPatients"
                                       asp-route-id="@record.RecordId"
                                       class="btn btn-sm btn-success shadow-sm d-flex align-items-center gap-1">
                                        <i class="bi bi-printer"></i> إخراج السجل
                                    </a>
                                </div>
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>
</div>
